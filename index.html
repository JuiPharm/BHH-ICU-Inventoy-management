<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <title>ICU Stock Management</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Tailwind via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              brand: {
                50: "#eff6ff",
                100: "#dbeafe",
                200: "#bfdbfe",
                300: "#93c5fd",
                400: "#60a5fa",
                500: "#3b82f6",
                600: "#2563eb",
                700: "#1d4ed8",
                800: "#1e40af",
                900: "#1e3a8a"
              }
            }
          }
        }
      };
    </script>

    <!-- Optional: ตั้งค่า API_BASE_URL ที่นี่ หรือใช้ config.js แยกก็ได้ -->
    <!-- <script>
      window.API_BASE_URL = "https://script.google.com/macros/s/xxxxxxxx/exec";
    </script> -->

    <link rel="icon" href="https://lh5.googleusercontent.com/d/1r7PM1ogHIbxskvcauVIYaQOfSHXWGncO" />
  </head>

  <body class="bg-slate-950 text-slate-100 min-h-screen">
    <!-- Loading overlay -->
    <div
      id="loadingOverlay"
      class="hidden fixed inset-0 z-40 flex items-center justify-center bg-slate-950/70 backdrop-blur-sm"
    >
      <div class="flex flex-col items-center gap-4">
        <div class="w-10 h-10 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"></div>
        <div class="text-sm text-slate-300 tracking-wide">กำลังประมวลผล...</div>
      </div>
    </div>

    <!-- Message modal -->
    <div
      id="msgModal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center bg-slate-950/70 backdrop-blur-sm"
    >
      <div class="mx-4 max-w-xl w-full bg-slate-900/95 border border-slate-700 rounded-2xl shadow-2xl">
        <div class="px-6 pt-5 pb-3 border-b border-slate-800 flex items-center justify-between">
          <h2 id="msgTitle" class="text-base font-semibold">Message</h2>
        </div>
        <div id="msgBody" class="px-6 py-4 text-sm text-slate-100 space-y-2"></div>
        <div class="px-6 pb-5 pt-2 flex justify-end">
          <button
            id="msgOk"
            type="button"
            class="inline-flex items-center px-4 py-2 rounded-full bg-brand-600 hover:bg-brand-500 text-sm font-medium shadow-sm transition"
          >
            OK
          </button>
        </div>
      </div>
    </div>

    <!-- LOGIN VIEW -->
    <div id="loginView" class="min-h-screen flex items-center justify-center px-4">
      <div
        class="relative max-w-md w-full bg-slate-900/90 border border-slate-800 rounded-3xl shadow-2xl px-7 py-8 sm:px-9 sm:py-10"
      >
        <div class="absolute -top-8 left-1/2 -translate-x-1/2">
          <div class="w-16 h-16 rounded-2xl bg-slate-950 border border-brand-500/40 flex items-center justify-center shadow-lg">
            <img
              src="https://lh5.googleusercontent.com/d/1r7PM1ogHIbxskvcauVIYaQOfSHXWGncO"
              alt="Logo"
              class="w-12 h-12 rounded-xl object-contain"
            />
          </div>
        </div>

        <div class="mt-6 text-center space-y-1">
          <h1 class="text-lg sm:text-xl font-semibold tracking-wide">ICU Stock Management</h1>
          <p class="text-xs sm:text-sm text-slate-400">
            GitHub Pages UI • Google Apps Script API
          </p>
        </div>

        <div class="mt-6 space-y-4">
          <div class="space-y-1 text-xs text-slate-400">
            <p>เข้าสู่ระบบเพื่อใช้งานเมนู Stock / Daily Check / Reports</p>
          </div>

          <div class="space-y-4">
            <div class="space-y-1">
              <label for="loginStaffId" class="block text-xs font-medium text-slate-300">StaffID</label>
              <input
                id="loginStaffId"
                type="text"
                class="w-full rounded-xl bg-slate-950/80 border border-slate-700 px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-brand-500 focus:border-brand-500"
                placeholder="เช่น admin หรือ 520294"
              />
            </div>

            <div class="space-y-1">
              <label for="loginPassword" class="block text-xs font-medium text-slate-300">Password</label>
              <div class="relative">
                <input
                  id="loginPassword"
                  type="password"
                  class="w-full rounded-xl bg-slate-950/80 border border-slate-700 px-3 py-2 pr-16 text-sm focus:outline-none focus:ring-1 focus:ring-brand-500 focus:border-brand-500"
                  placeholder="Password"
                />
                <button
                  id="btnTogglePw"
                  type="button"
                  class="absolute inset-y-0 right-1 my-1 px-3 rounded-lg text-xs text-slate-300 hover:bg-slate-800/80"
                >
                  Show
                </button>
              </div>
            </div>

            <div class="flex flex-col sm:flex-row gap-2 mt-2">
              <button
                id="btnLogin"
                type="button"
                class="flex-1 inline-flex items-center justify-center rounded-full bg-brand-600 hover:bg-brand-500 px-4 py-2 text-sm font-medium shadow-md transition"
              >
                Login
              </button>
              <button
                id="btnFirstTimeInit"
                type="button"
                class="flex-1 inline-flex items-center justify-center rounded-full border border-slate-600 hover:border-brand-500 hover:text-brand-200 px-4 py-2 text-xs font-medium text-slate-300 transition"
              >
                First-time setup: Initialize Sheets
              </button>
            </div>
          </div>

          <div
            id="loginInfo"
            class="mt-4 text-xs text-slate-300 bg-slate-950/60 border border-dashed border-slate-700 rounded-xl px-3 py-2 space-y-1"
            hidden
          ></div>

          <div class="mt-3 text-[11px] text-slate-500 text-center">
            หากเพิ่งเปิดใช้งานครั้งแรก ให้กด <span class="font-semibold text-slate-300">"Initialize Sheets"</span> เพื่อสร้างและตรวจสอบตารางใน Google
            Sheets
          </div>
        </div>
      </div>
    </div>

    <!-- APP VIEW -->
    <div id="appView" class="hidden min-h-screen flex flex-col">
      <!-- Top bar -->
      <header
        class="h-16 flex items-center justify-between px-4 sm:px-6 border-b border-slate-800 bg-slate-950/95 backdrop-blur z-20"
      >
        <div class="flex items-center gap-3">
          <div class="hidden sm:flex items-center gap-3">
            <div
              class="w-9 h-9 rounded-xl bg-slate-900 border border-brand-500/60 flex items-center justify-center shadow"
            >
              <img
                src="https://lh5.googleusercontent.com/d/1r7PM1ogHIbxskvcauVIYaQOfSHXWGncO"
                alt="Logo"
                class="w-7 h-7 rounded-lg object-contain"
              />
            </div>
            <div class="leading-tight">
              <div class="text-sm font-semibold">ICU Stock Management</div>
              <div class="text-[11px] text-slate-400">
                GitHub Pages UI · Google Apps Script API
              </div>
            </div>
          </div>
          <div class="sm:hidden flex items-center gap-2">
            <div
              class="w-8 h-8 rounded-xl bg-slate-900 border border-brand-500/60 flex items-center justify-center shadow"
            >
              <img
                src="https://lh5.googleusercontent.com/d/1r7PM1ogHIbxskvcauVIYaQOfSHXWGncO"
                alt="Logo"
                class="w-6 h-6 rounded-lg object-contain"
              />
            </div>
            <span class="text-sm font-semibold">ICU Stock</span>
          </div>
        </div>

        <div id="userBox" class="flex items-center gap-3 text-xs sm:text-sm">
          <div class="text-right leading-tight">
            <div id="userName" class="font-medium truncate max-w-[9rem] sm:max-w-xs"></div>
            <div id="userRole" class="text-[11px] text-slate-400"></div>
          </div>
          <button
            id="btnLogout"
            type="button"
            class="inline-flex items-center rounded-full border border-slate-700 px-3 py-1 text-xs font-medium text-slate-200 hover:bg-slate-800 transition"
          >
            Logout
          </button>
        </div>
      </header>

      <!-- Main layout -->
      <div class="flex flex-1 overflow-hidden">
        <!-- Desktop sidebar -->
        <aside
          class="hidden md:flex w-60 lg:w-64 flex-col border-r border-slate-800 bg-slate-950/98 backdrop-blur-sm"
        >
          <div class="px-4 pt-4 pb-2 text-[11px] text-slate-500">
            เมนู (Desktop): เลือกจากแถบด้านซ้าย · (Mobile): ใช้ Bottom Nav
          </div>
          <nav id="desktopNav" class="flex-1 px-2 pb-4 space-y-1"></nav>
        </aside>

        <!-- Content -->
        <main class="flex-1 flex flex-col bg-gradient-to-b from-slate-950 via-slate-950 to-slate-900">
          <!-- Page header inside content -->
          <div
            class="px-4 sm:px-6 py-3 border-b border-slate-800 flex items-center justify-between gap-4 bg-slate-950/90"
          >
            <div class="space-y-0.5">
              <div class="text-[11px] uppercase tracking-[0.18em] text-slate-500 flex items-center gap-2">
                <span>Dashboard</span>
                <span class="rounded-full bg-slate-800 px-2 py-[2px] text-[10px] text-slate-300">
                  ICU Stock Management
                </span>
              </div>
              <h1 id="panelTitle" class="text-base sm:text-lg font-semibold text-slate-50">
                Home
              </h1>
            </div>
            <div id="panelActions" class="flex flex-wrap gap-2 justify-end"></div>
          </div>

          <!-- Legacy tabs container (kept for compatibility, hidden) -->
          <div id="tabs" class="hidden"></div>

          <!-- Panel body -->
          <section
            id="panelBody"
            class="flex-1 overflow-auto px-4 sm:px-6 py-4 sm:py-6 text-sm text-slate-100"
          ></section>
        </main>
      </div>

      <!-- Mobile bottom nav + Admin sheet -->
      <nav
        id="bottomNav"
        class="md:hidden fixed bottom-0 inset-x-0 z-30 bg-slate-950/95 border-t border-slate-800 backdrop-blur"
      >
        <!-- Admin sheet -->
        <div id="adminSheet" class="hidden absolute inset-x-0 bottom-14 px-4 pb-3">
          <div
            class="bg-slate-900/95 border border-slate-700 rounded-2xl shadow-2xl max-w-xl mx-auto p-4 space-y-3"
          >
            <div class="flex items-center justify-between">
              <div class="text-xs font-semibold text-slate-200 tracking-wide">
                Admin Console
              </div>
              <button
                id="adminSheetClose"
                type="button"
                class="w-7 h-7 inline-flex items-center justify-center rounded-full bg-slate-800 hover:bg-slate-700 text-slate-200 text-xs"
              >
                ✕
              </button>
            </div>
            <div class="grid grid-cols-3 gap-2 text-[11px] text-center">
              <button
                data-admin-tab="inventory"
                type="button"
                class="flex flex-col items-center gap-1 rounded-xl bg-slate-800/80 hover:bg-slate-700/80 px-2 py-3"
              >
                <span class="w-7 h-7 rounded-full bg-slate-900 flex items-center justify-center text-brand-300">
                  <!-- box icon -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                      d="M3.75 7.5 12 3.75l8.25 3.75M4.5 9.75v6.75L12 20.25l7.5-3.75V9.75" />
                  </svg>
                </span>
                <span>Inventory</span>
              </button>

              <button
                data-admin-tab="daily"
                type="button"
                class="flex flex-col items-center gap-1 rounded-xl bg-slate-800/80 hover:bg-slate-700/80 px-2 py-3"
              >
                <span class="w-7 h-7 rounded-full bg-slate-900 flex items-center justify-center text-brand-300">
                  <!-- calendar icon -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                      d="M8 7V4.5M16 7V4.5M4.5 9.75h15M6 5.25h12A1.5 1.5 0 0 1 19.5 6.75v10.5A1.5 1.5 0 0 1 18 18.75H6A1.5 1.5 0 0 1 4.5 17.25V6.75A1.5 1.5 0 0 1 6 5.25Z" />
                  </svg>
                </span>
                <span>Daily Check</span>
              </button>

              <button
                data-admin-tab="admin"
                type="button"
                class="flex flex-col items-center gap-1 rounded-xl bg-slate-800/80 hover:bg-slate-700/80 px-2 py-3"
              >
                <span class="w-7 h-7 rounded-full bg-slate-900 flex items-center justify-center text-brand-300">
                  <!-- cog icon -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                      d="M10.325 4.317 9.6 2.25m4.8 2.067.725-2.067M6.72 7.5 4.98 6.28m13.04 1.22L17.28 7.5M4.5 12H2.25m19.5 0H19.5m-2.78 4.5 1.74 1.22M6.72 16.5 4.98 17.72M13.5 21.75 12.75 19.5m-1.5 2.25L10.5 19.5M12 9.75A2.25 2.25 0 1 0 12 14.25a2.25 2.25 0 0 0 0-4.5Z" />
                  </svg>
                </span>
                <span>Admin</span>
              </button>

              <button
                data-admin-tab="reorder"
                type="button"
                class="flex flex-col items-center gap-1 rounded-xl bg-slate-800/80 hover:bg-slate-700/80 px-2 py-3"
              >
                <span class="w-7 h-7 rounded-full bg-slate-900 flex items-center justify-center text-brand-300">
                  <!-- arrows icon -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                      d="M4.5 6.75 9 2.25v3a8.25 8.25 0 0 1 7.5 8.22v.03M19.5 17.25 15 21.75v-3a8.25 8.25 0 0 1-7.5-8.22v-.03" />
                  </svg>
                </span>
                <span>Reorder</span>
              </button>

              <button
                data-admin-tab="expired"
                type="button"
                class="flex flex-col items-center gap-1 rounded-xl bg-slate-800/80 hover:bg-slate-700/80 px-2 py-3"
              >
                <span class="w-7 h-7 rounded-full bg-slate-900 flex items-center justify-center text-brand-300">
                  <!-- warning icon -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                      d="M12 9v3.75M12 15.75h.007M3.75 19.5h16.5L12 4.5 3.75 19.5Z" />
                  </svg>
                </span>
                <span>Expired</span>
              </button>

              <button
                data-admin-tab="usage"
                type="button"
                class="flex flex-col items-center gap-1 rounded-xl bg-slate-800/80 hover:bg-slate-700/80 px-2 py-3"
              >
                <span class="w-7 h-7 rounded-full bg-slate-900 flex items-center justify-center text-brand-300">
                  <!-- receipt icon -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                      d="M9 7.5h6M9 12h6M9 16.5h3M6.75 4.5h10.5A1.75 1.75 0 0 1 19 6.25v13.5l-3-1.5-3 1.5-3-1.5-3 1.5V6.25A1.75 1.75 0 0 1 6.75 4.5Z" />
                  </svg>
                </span>
                <span>Usage Logs</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Bottom nav bar -->
        <div class="max-w-xl mx-auto flex items-center justify-between px-4 py-1.5">
          <!-- Home = Inventory -->
          <button
            type="button"
            data-bottom-tab="home"
            class="flex flex-col items-center justify-center flex-1 gap-0.5 text-[11px] text-slate-400"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                d="M3.75 10.5 12 4.5l8.25 6v7.75A1.75 1.75 0 0 1 18.5 20H5.5A1.75 1.75 0 0 1 3.75 18.25V10.5Z" />
            </svg>
            <span>Home</span>
          </button>

          <button
            type="button"
            data-bottom-tab="daily"
            class="flex flex-col items-center justify-center flex-1 gap-0.5 text-[11px] text-slate-400"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                d="M8 7V4.75M16 7V4.75M4.5 9.75h15M6 5.25h12A1.5 1.5 0 0 1 19.5 6.75v10.5A1.5 1.5 0 0 1 18 18.75H6A1.5 1.5 0 0 1 4.5 17.25V6.75A1.5 1.5 0 0 1 6 5.25Z" />
            </svg>
            <span>Daily</span>
          </button>

          <!-- Admin floating button (center) -->
          <button
            id="adminFab"
            type="button"
            class="relative -mt-4 flex items-center justify-center rounded-full bg-brand-600 text-white shadow-lg shadow-brand-900/60 w-10 h-10 border-2 border-slate-950"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
                d="M4 6h16M4 12h16M4 18h10" />
            </svg>
          </button>

          <button
            type="button"
            data-bottom-tab="usage"
            class="flex flex-col items-center justify-center flex-1 gap-0.5 text-[11px] text-slate-400"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                d="M6.75 4.5h10.5A1.75 1.75 0 0 1 19 6.25v11.5l-3-1.5-3 1.5-3-1.5-3 1.5V6.25A1.75 1.75 0 0 1 6.75 4.5Z" />
            </svg>
            <span>Usage</span>
          </button>

          <button
            type="button"
            data-bottom-tab="profile"
            class="flex flex-col items-center justify-center flex-1 gap-0.5 text-[11px] text-slate-400"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                d="M15.75 8.25A3.75 3.75 0 1 1 12 4.5a3.75 3.75 0 0 1 3.75 3.75Z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                d="M4.5 19.5A7.5 7.5 0 0 1 12 12a7.5 7.5 0 0 1 7.5 7.5" />
            </svg>
            <span>Profile</span>
          </button>
        </div>
      </nav>
    </div>

    <!-- Application logic -->
    <script src="app.js" defer></script>
  </body>
</html>
